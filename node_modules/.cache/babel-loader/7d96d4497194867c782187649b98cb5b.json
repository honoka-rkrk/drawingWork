{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,useContext,useEffect}from'react';import{useHistory}from'react-router';import firebase,{db}from'../../../firebase';import{UserContext}from'../../../Context/contexts';import CompEntryBtn from'../../Component/Btn/entryBtn';import{jsx as _jsx}from\"react/jsx-runtime\";var EntryBtn=function EntryBtn(props){var isMax=props.isMax,setIsMax=props.setIsMax;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),infOpen=_useState2[0],setInfOpen=_useState2[1];var history=useHistory();var _useContext=useContext(UserContext),user=_useContext.user;var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),disabled=_useState4[0],setDisabled=_useState4[1];useEffect(function(){if(user){setDisabled(false);}else{setDisabled(true);}},[user]);var doneEntry=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(numbers){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(numbers===20)){_context.next=5;break;}_context.next=3;return db.collection('entryMembers').doc('entryNumber').set({numbers:firebase.firestore.FieldValue.increment(1),maximum:true});case 3:_context.next=7;break;case 5:_context.next=7;return db.collection('entryMembers').doc('entryNumber').set({numbers:firebase.firestore.FieldValue.increment(1),maximum:false},{merge:true});case 7:case\"end\":return _context.stop();}}},_callee);}));return function doneEntry(_x){return _ref.apply(this,arguments);};}();var getMember=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var unmounted,entoryMembersRef;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:unmounted=false;entoryMembersRef=db.collection('entryMembers').doc('entryNumber');_context2.next=4;return entoryMembersRef.get().then(function(doc){if(doc.exists){var getData=doc.data();if(!getData.maximum){doneEntry(getData.numbers);history.push('/chat');}else{if(!unmounted){setInfOpen(true);setIsMax(true);}}}else{doneEntry(0);history.push('/chat');}}).catch(function(error){console.log('Error getting document',error);});case 4:return _context2.abrupt(\"return\",function(){unmounted=true;});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function getMember(){return _ref2.apply(this,arguments);};}();var entryClick=useCallback(function(){getMember();},[]);return/*#__PURE__*/_jsx(CompEntryBtn,{infOpen:infOpen,setInfOpen:setInfOpen,entryClick:entryClick,isMax:isMax,disabled:disabled});};export default EntryBtn;","map":{"version":3,"sources":["/Users/rakuraku2563/Desktop/drawingWork/src/Home/Container/Btn/entryBtn.tsx"],"names":["React","useState","useCallback","useContext","useEffect","useHistory","firebase","db","UserContext","CompEntryBtn","EntryBtn","props","isMax","setIsMax","infOpen","setInfOpen","history","user","disabled","setDisabled","doneEntry","numbers","collection","doc","set","firestore","FieldValue","increment","maximum","merge","getMember","unmounted","entoryMembersRef","get","then","exists","getData","data","push","catch","error","console","log","entryClick"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useContext, useEffect } from 'react';\nimport { useHistory } from 'react-router';\nimport firebase, { db } from '../../../firebase';\n\nimport { UserContext } from '../../../Context/contexts';\nimport CompEntryBtn from '../../Component/Btn/entryBtn';\n\ntype EntryBtnProps = {\n  isMax: boolean;\n  setIsMax: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nconst EntryBtn: React.FC<EntryBtnProps> = (props: EntryBtnProps) => {\n  const { isMax, setIsMax } = props;\n  const [infOpen, setInfOpen] = useState<boolean>(false);\n  const history = useHistory();\n  const { user } = useContext(UserContext);\n  const [disabled, setDisabled] = useState<boolean>(true);\n\n  useEffect(() => {\n    if (user) {\n      setDisabled(false);\n    } else {\n      setDisabled(true);\n    }\n  }, [user]);\n\n  const doneEntry = async (numbers: number) => {\n    if (numbers === 20) {\n      await db\n        .collection('entryMembers')\n        .doc('entryNumber')\n        .set({\n          numbers: firebase.firestore.FieldValue.increment(1),\n          maximum: true\n        });\n    } else {\n      await db\n        .collection('entryMembers')\n        .doc('entryNumber')\n        .set(\n          {\n            numbers: firebase.firestore.FieldValue.increment(1),\n            maximum: false\n          },\n          { merge: true }\n        );\n    }\n  };\n\n  const getMember = async () => {\n    let unmounted = false;\n    const entoryMembersRef = db.collection('entryMembers').doc('entryNumber');\n    await entoryMembersRef\n      .get()\n      .then((doc) => {\n        if (doc.exists) {\n          const getData: any = doc.data();\n          if (!getData.maximum) {\n            doneEntry(getData.numbers);\n            history.push('/chat');\n          } else {\n            if (!unmounted) {\n              setInfOpen(true);\n              setIsMax(true);\n            }\n          }\n        } else {\n          doneEntry(0);\n          history.push('/chat');\n        }\n      })\n      .catch((error) => {\n        console.log('Error getting document', error);\n      });\n\n    return () => {\n      unmounted = true;\n    };\n  };\n\n  const entryClick = useCallback(() => {\n    getMember();\n  }, []);\n\n  return (\n    <CompEntryBtn\n      infOpen={infOpen}\n      setInfOpen={setInfOpen}\n      entryClick={entryClick}\n      isMax={isMax}\n      disabled={disabled}\n    />\n  );\n};\n\nexport default EntryBtn;\n"]},"metadata":{},"sourceType":"module"}