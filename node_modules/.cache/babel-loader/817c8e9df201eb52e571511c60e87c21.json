{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{db}from\"../../firebase\";import CompDispPicture from\"../../Home/Component/dispPicture\";import{jsx as _jsx}from\"react/jsx-runtime\";var DispPicture=function DispPicture(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),images=_useState2[0],setImages=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),activeStep=_useState4[0],setActiveStep=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),maxSteps=_useState6[0],setMaxSteps=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),image=_useState8[0],setImage=_useState8[1];//前回の画像を取得\nuseEffect(function(){var unmounted=false;var getImages=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var imagesRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:imagesRef=db.collection(\"images\");_context.next=3;return imagesRef.orderBy(\"createdAt\").get().then(function(snapshot){var newImages=[];snapshot.forEach(function(doc){newImages.push(_objectSpread({id:doc.id},doc.data()));});if(!unmounted&&newImages){setImages(newImages);setMaxSteps(newImages.length);}});case 3:case\"end\":return _context.stop();}}},_callee);}));return function getImages(){return _ref.apply(this,arguments);};}();getImages();return function(){unmounted=true;};},[]);var handleNext=function handleNext(){setActiveStep(function(prevActiveStep){return prevActiveStep+1;});};var handleBack=function handleBack(){setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};var handleStepChange=function handleStepChange(step){setActiveStep(step);};useEffect(function(){if(images){setImage(images[activeStep]);}},[images,activeStep]);return/*#__PURE__*/_jsx(CompDispPicture,{images:images,activeStep:activeStep,maxSteps:maxSteps,handleNext:handleNext,handleBack:handleBack,handleStepChange:handleStepChange,image:image});};export default DispPicture;","map":{"version":3,"sources":["/Users/rakuraku2563/Desktop/drawingWork/src/Home/Container/dispPicture.tsx"],"names":["React","useState","useEffect","db","CompDispPicture","DispPicture","images","setImages","activeStep","setActiveStep","maxSteps","setMaxSteps","image","setImage","unmounted","getImages","imagesRef","collection","orderBy","get","then","snapshot","newImages","forEach","doc","push","id","data","length","handleNext","prevActiveStep","handleBack","handleStepChange","step"],"mappings":"onBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAAmD,OAAnD,CACA,OAAmBC,EAAnB,KAA6B,gBAA7B,CAGA,MAAOC,CAAAA,eAAP,KAA4B,kCAA5B,C,2CAEA,GAAMC,CAAAA,WAAqB,CAAG,QAAxBA,CAAAA,WAAwB,EAAM,CAClC,cAA4BJ,QAAQ,CAAsB,IAAtB,CAApC,wCAAOK,MAAP,eAAeC,SAAf,eACA,eAAoCN,QAAQ,CAAS,CAAT,CAA5C,yCAAOO,UAAP,eAAmBC,aAAnB,eACA,eAAgCR,QAAQ,CAAS,CAAT,CAAxC,yCAAOS,QAAP,eAAiBC,WAAjB,eACA,eAA0BV,QAAQ,CAAe,IAAf,CAAlC,yCAAOW,KAAP,eAAcC,QAAd,eAEA;AACAX,SAAS,CAAC,UAAM,CACd,GAAIY,CAAAA,SAAS,CAAG,KAAhB,CACA,GAAMC,CAAAA,SAAS,0FAAG,iJACVC,SADU,CACEb,EAAE,CAACc,UAAH,CAAc,QAAd,CADF,uBAEVD,CAAAA,SAAS,CACZE,OADG,CACK,WADL,EAEHC,GAFG,GAGHC,IAHG,CAGE,SAACC,QAAD,CAAgD,CACpD,GAAMC,CAAAA,SAAgB,CAAG,EAAzB,CACAD,QAAQ,CAACE,OAAT,CAAiB,SAACC,GAAD,CAAS,CACxBF,SAAS,CAACG,IAAV,gBACEC,EAAE,CAAEF,GAAG,CAACE,EADV,EAEKF,GAAG,CAACG,IAAJ,EAFL,GAID,CALD,EAMA,GAAI,CAACb,SAAD,EAAcQ,SAAlB,CAA6B,CAC3Bf,SAAS,CAACe,SAAD,CAAT,CACAX,WAAW,CAACW,SAAS,CAACM,MAAX,CAAX,CACD,CACF,CAfG,CAFU,uDAAH,kBAATb,CAAAA,SAAS,0CAAf,CAmBAA,SAAS,GACT,MAAO,WAAM,CACXD,SAAS,CAAG,IAAZ,CACD,CAFD,CAGD,CAzBQ,CAyBN,EAzBM,CAAT,CA2BA,GAAMe,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBpB,aAAa,CAAC,SAACqB,cAAD,QAAoBA,CAAAA,cAAc,CAAG,CAArC,EAAD,CAAb,CACD,CAFD,CAIA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBtB,aAAa,CAAC,SAACqB,cAAD,QAAoBA,CAAAA,cAAc,CAAG,CAArC,EAAD,CAAb,CACD,CAFD,CAIA,GAAME,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,IAAD,CAAkB,CACzCxB,aAAa,CAACwB,IAAD,CAAb,CACD,CAFD,CAIA/B,SAAS,CAAC,UAAM,CACd,GAAII,MAAJ,CAAY,CACVO,QAAQ,CAACP,MAAM,CAACE,UAAD,CAAP,CAAR,CACD,CACF,CAJQ,CAIN,CAACF,MAAD,CAASE,UAAT,CAJM,CAAT,CAMA,mBACE,KAAC,eAAD,EACE,MAAM,CAAEF,MADV,CAEE,UAAU,CAAEE,UAFd,CAGE,QAAQ,CAAEE,QAHZ,CAIE,UAAU,CAAEmB,UAJd,CAKE,UAAU,CAAEE,UALd,CAME,gBAAgB,CAAEC,gBANpB,CAOE,KAAK,CAAEpB,KAPT,EADF,CAWD,CA/DD,CAiEA,cAAeP,CAAAA,WAAf","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport firebase, { db } from \"../../firebase\";\nimport { Image } from \"../../Model/image\";\n\nimport CompDispPicture from \"../../Home/Component/dispPicture\";\n\nconst DispPicture: React.FC = () => {\n  const [images, setImages] = useState<Array<Image> | null>(null);\n  const [activeStep, setActiveStep] = useState<number>(0);\n  const [maxSteps, setMaxSteps] = useState<number>(0);\n  const [image, setImage] = useState<Image | null>(null);\n\n  //前回の画像を取得\n  useEffect(() => {\n    let unmounted = false;\n    const getImages = async () => {\n      const imagesRef = db.collection(\"images\");\n      await imagesRef\n        .orderBy(\"createdAt\")\n        .get()\n        .then((snapshot: firebase.firestore.QuerySnapshot) => {\n          const newImages: any[] = [];\n          snapshot.forEach((doc) => {\n            newImages.push({\n              id: doc.id,\n              ...doc.data(),\n            });\n          });\n          if (!unmounted && newImages) {\n            setImages(newImages);\n            setMaxSteps(newImages.length);\n          }\n        });\n    };\n    getImages();\n    return () => {\n      unmounted = true;\n    };\n  }, []);\n\n  const handleNext = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  const handleStepChange = (step: number) => {\n    setActiveStep(step);\n  };\n\n  useEffect(() => {\n    if (images) {\n      setImage(images[activeStep]);\n    }\n  }, [images, activeStep]);\n\n  return (\n    <CompDispPicture\n      images={images}\n      activeStep={activeStep}\n      maxSteps={maxSteps}\n      handleNext={handleNext}\n      handleBack={handleBack}\n      handleStepChange={handleStepChange}\n      image={image}\n    />\n  );\n};\n\nexport default DispPicture;\n"]},"metadata":{},"sourceType":"module"}