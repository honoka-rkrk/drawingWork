{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rakuraku2563/Desktop/drawingWork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback}from'react';import moment from'moment';import{useHistory}from'react-router-dom';import CompTimer from'../Component/timer';import{jsx as _jsx}from\"react/jsx-runtime\";var Timer=function Timer(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),end=_useState2[0],setEnd=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),tmMinutes=_useState4[0],setTmMinutes=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),tmSeconds=_useState6[0],setTmSeconds=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),danger=_useState8[0],setDanger=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isEnd=_useState10[0],setIsEnd=_useState10[1];var history=useHistory();useEffect(function(){var dtNow=moment().startOf('day');// const endHour = dtNow.add(18, 'hours');\n// const endTime = endHour.add(6, 'minutes');\nvar endTime=moment().add(30,'seconds');setEnd(endTime);},[setEnd]);var updateTime=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var dtNow,timerDiff;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dtNow=moment();if(end){timerDiff=end.diff(dtNow,'second');setTmMinutes(String(Math.floor(timerDiff/60)));setTmSeconds(String(timerDiff%60));if(timerDiff===0){setIsEnd(true);}if(Math.floor(timerDiff/60)<1){setDanger(true);}}case 2:case\"end\":return _context.stop();}}},_callee);})),[end]);useEffect(function(){if(!isEnd){var updateTimeId=setInterval(updateTime,500);updateTime();return function(){clearInterval(updateTimeId);};}else{return;}},[updateTime,isEnd]);var clickOK=useCallback(function(){history.push('/');},[]);return/*#__PURE__*/_jsx(CompTimer,{tmMinutes:tmMinutes,tmSeconds:tmSeconds,danger:danger,isEnd:isEnd,clickOK:clickOK});};export default Timer;","map":{"version":3,"sources":["/Users/rakuraku2563/Desktop/drawingWork/src/DispPicture/Container/timer.tsx"],"names":["React","useState","useEffect","useCallback","moment","useHistory","CompTimer","Timer","end","setEnd","tmMinutes","setTmMinutes","tmSeconds","setTmSeconds","danger","setDanger","isEnd","setIsEnd","history","dtNow","startOf","endTime","add","updateTime","timerDiff","diff","String","Math","floor","updateTimeId","setInterval","clearInterval","clickOK","push"],"mappings":"udAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,WAArC,KAAwD,OAAxD,CACA,MAAOC,CAAAA,MAAP,KAA+B,QAA/B,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,MAAOC,CAAAA,SAAP,KAAsB,oBAAtB,C,2CAEA,GAAMC,CAAAA,KAAe,CAAG,QAAlBA,CAAAA,KAAkB,EAAM,CAC5B,cAAsBN,QAAQ,CAAgB,IAAhB,CAA9B,wCAAOO,GAAP,eAAYC,MAAZ,eACA,eAAkCR,QAAQ,CAAS,EAAT,CAA1C,yCAAOS,SAAP,eAAkBC,YAAlB,eACA,eAAkCV,QAAQ,CAAS,EAAT,CAA1C,yCAAOW,SAAP,eAAkBC,YAAlB,eACA,eAA4BZ,QAAQ,CAAU,KAAV,CAApC,yCAAOa,MAAP,eAAeC,SAAf,eACA,eAA0Bd,QAAQ,CAAU,KAAV,CAAlC,0CAAOe,KAAP,gBAAcC,QAAd,gBACA,GAAMC,CAAAA,OAAO,CAAGb,UAAU,EAA1B,CAEAH,SAAS,CAAC,UAAM,CACd,GAAMiB,CAAAA,KAAK,CAAGf,MAAM,GAAGgB,OAAT,CAAiB,KAAjB,CAAd,CACA;AACA;AACA,GAAMC,CAAAA,OAAO,CAAGjB,MAAM,GAAGkB,GAAT,CAAa,EAAb,CAAiB,SAAjB,CAAhB,CACAb,MAAM,CAACY,OAAD,CAAN,CACD,CANQ,CAMN,CAACZ,MAAD,CANM,CAAT,CAQA,GAAMc,CAAAA,UAAU,CAAGpB,WAAW,sEAAC,uJACvBgB,KADuB,CACff,MAAM,EADS,CAE7B,GAAII,GAAJ,CAAS,CACDgB,SADC,CACWhB,GAAG,CAACiB,IAAJ,CAASN,KAAT,CAAgB,QAAhB,CADX,CAEPR,YAAY,CAACe,MAAM,CAACC,IAAI,CAACC,KAAL,CAAWJ,SAAS,CAAG,EAAvB,CAAD,CAAP,CAAZ,CACAX,YAAY,CAACa,MAAM,CAACF,SAAS,CAAG,EAAb,CAAP,CAAZ,CACA,GAAIA,SAAS,GAAK,CAAlB,CAAqB,CACnBP,QAAQ,CAAC,IAAD,CAAR,CACD,CACD,GAAIU,IAAI,CAACC,KAAL,CAAWJ,SAAS,CAAG,EAAvB,EAA6B,CAAjC,CAAoC,CAClCT,SAAS,CAAC,IAAD,CAAT,CACD,CACF,CAZ4B,sDAAD,GAa3B,CAACP,GAAD,CAb2B,CAA9B,CAeAN,SAAS,CAAC,UAAM,CACd,GAAI,CAACc,KAAL,CAAY,CACV,GAAMa,CAAAA,YAAY,CAAGC,WAAW,CAACP,UAAD,CAAa,GAAb,CAAhC,CACAA,UAAU,GACV,MAAO,WAAM,CACXQ,aAAa,CAACF,YAAD,CAAb,CACD,CAFD,CAGD,CAND,IAMO,CACL,OACD,CACF,CAVQ,CAUN,CAACN,UAAD,CAAaP,KAAb,CAVM,CAAT,CAYA,GAAMgB,CAAAA,OAAO,CAAG7B,WAAW,CAAC,UAAM,CAChCe,OAAO,CAACe,IAAR,CAAa,GAAb,EACD,CAF0B,CAExB,EAFwB,CAA3B,CAIA,mBACE,KAAC,SAAD,EACE,SAAS,CAAEvB,SADb,CAEE,SAAS,CAAEE,SAFb,CAGE,MAAM,CAAEE,MAHV,CAIE,KAAK,CAAEE,KAJT,CAKE,OAAO,CAAEgB,OALX,EADF,CASD,CAxDD,CA0DA,cAAezB,CAAAA,KAAf","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport moment, { Moment } from 'moment';\nimport { useHistory } from 'react-router-dom';\n\nimport CompTimer from '../Component/timer';\n\nconst Timer: React.FC = () => {\n  const [end, setEnd] = useState<Moment | null>(null);\n  const [tmMinutes, setTmMinutes] = useState<string>('');\n  const [tmSeconds, setTmSeconds] = useState<string>('');\n  const [danger, setDanger] = useState<boolean>(false);\n  const [isEnd, setIsEnd] = useState<boolean>(false);\n  const history = useHistory();\n\n  useEffect(() => {\n    const dtNow = moment().startOf('day');\n    // const endHour = dtNow.add(18, 'hours');\n    // const endTime = endHour.add(6, 'minutes');\n    const endTime = moment().add(30, 'seconds');\n    setEnd(endTime);\n  }, [setEnd]);\n\n  const updateTime = useCallback(async () => {\n    const dtNow = moment();\n    if (end) {\n      const timerDiff = end.diff(dtNow, 'second');\n      setTmMinutes(String(Math.floor(timerDiff / 60)));\n      setTmSeconds(String(timerDiff % 60));\n      if (timerDiff === 0) {\n        setIsEnd(true);\n      }\n      if (Math.floor(timerDiff / 60) < 1) {\n        setDanger(true);\n      }\n    }\n  }, [end]);\n\n  useEffect(() => {\n    if (!isEnd) {\n      const updateTimeId = setInterval(updateTime, 500);\n      updateTime();\n      return () => {\n        clearInterval(updateTimeId);\n      };\n    } else {\n      return;\n    }\n  }, [updateTime, isEnd]);\n\n  const clickOK = useCallback(() => {\n    history.push('/');\n  }, []);\n\n  return (\n    <CompTimer\n      tmMinutes={tmMinutes}\n      tmSeconds={tmSeconds}\n      danger={danger}\n      isEnd={isEnd}\n      clickOK={clickOK}\n    />\n  );\n};\n\nexport default Timer;\n"]},"metadata":{},"sourceType":"module"}